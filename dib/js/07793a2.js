/*!
 * jQuery Smart Banner
 * Copyright (c) 2012 Arnold Daniels <arnold@jasny.net>
 * Based on 'jQuery Smart Web App Banner' by Kurt Zenisek @ kzeni.com
 */
;!function(c){var a=function(e){this.origHtmlMargin=parseFloat(c("html").css("margin-top"));this.options=c.extend({},c.smartbanner.defaults,e);var d=navigator.standalone,f=navigator.userAgent;if(this.options.force){this.type=this.options.force}else{if(f.match(/iPhone|iPod/i)!=null||(f.match(/iPad/)&&this.options.iOSUniversalApp)&&f.match(/CriOS/i)!=null){this.type="ios"}else{if(f.match(/\bSilk\/(.*\bMobile Safari\b)?/)||f.match(/\bKF\w/)||f.match("Kindle Fire")){this.type="kindle"}else{if(f.match(/Android/i)!=null){this.type="android"}else{if(f.match(/Windows NT 6.2/i)!=null&&f.match(/Touch/i)!==null){this.type="windows"}}}}}if(!this.type||d||this.getCookie("sb-closed")||this.getCookie("sb-installed")){return}datalayer.Custom={};datalayer.Custom.banner="smart app banner";datalayer["Evénement"]={};datalayer["Evénement"].event=32;this.scale=this.options.scale=="auto"?c(window).width()/window.screen.width:this.options.scale;if(this.scale<1){this.scale=1}var g=c(this.type=="android"?'meta[name="google-play-app"]':this.type=="ios"?'meta[name="apple-itunes-app-id"]':this.type=="kindle"?'meta[name="kindle-fire-app"]':'meta[name="msApplication-ID"]');if(g.length==0){return}if(this.type=="windows"){this.pfn=c('meta[name="msApplication-PackageFamilyName"]').attr("content");this.appId=g.attr("content")[1]}else{this.appId=/app-id=([^\s,]+)/.exec(g.attr("content"))[1]}this.author=this.options.author?this.options.author:g.data("author")||(c('meta[name="author"]').length?c('meta[name="author"]').attr("content"):window.location.hostname);this.iconUrl=g.data("icon-url");this.price=g.data("price");this.create();this.show();this.listen()};a.prototype={constructor:a,create:function(){var g,f=null,e=this.price||this.options.price,i=e?e+" - "+(this.type=="android"?this.options.inGooglePlay:this.type=="kindle"?this.options.inAmazonAppStore:this.type=="ios"?this.options.inAppStore:this.options.inWindowsStore):"",h=this.options.iconGloss===null?(this.type=="ios"):this.options.iconGloss;if(this.options.url){f=this.options.url}else{if(this.type=="android"){this.title="Banque - Caisse d'Epargne";f="https://play.google.com/store/apps/details?id="+this.appId+"&referrer=utm_source%3Donsite%26utm_medium%3Dsmartadbanner%26utm_campaign%3Ddownload-appli-android"}else{this.title="Banxo - Caisse d'Epargne";f="https://itunes.apple.com/app/apple-store/id"+this.appId+"?pt=437053&ct=onsite-smartadbanner-download-appli-ios&mt=8"}}var d='<div id="smartbanner" class="'+this.type+'"><div class="sb-container"><a href="#" class="sb-close">&times;</a><span class="sb-icon"></span><div class="sb-info"><strong>'+this.title+"</strong><span>"+this.author+"</span><span>"+i+'</span></div><a href="'+f+'" class="sb-button"><span>'+this.options.button+"</span></a></div></div>";(this.options.layer)?c(this.options.appendToSelector).append(d):c(this.options.appendToSelector).prepend(d);if(this.options.icon){g=this.options.icon}else{if(this.iconUrl){g=this.iconUrl}else{if(c('link[rel="apple-touch-icon-precomposed"]').length>0){g=c('link[rel="apple-touch-icon-precomposed"]').attr("href");if(this.options.iconGloss===null){h=false}}else{if(c('link[rel="apple-touch-icon"]').length>0){g=c('link[rel="apple-touch-icon"]').attr("href")}else{if(c('meta[name="msApplication-TileImage"]').length>0){g=c('meta[name="msApplication-TileImage"]').attr("content")}else{if(c('meta[name="msapplication-TileImage"]').length>0){g=c('meta[name="msapplication-TileImage"]').attr("content")}}}}}}if(g){if(h){c("#smartbanner .sb-icon").addClass("gloss")}}else{c("#smartbanner").addClass("no-icon")}this.bannerHeight=c("#smartbanner").outerHeight()+2;if(this.scale>1){c("#smartbanner").css("top",parseFloat(c("#smartbanner").css("top"))*this.scale).css("height",parseFloat(c("#smartbanner").css("height"))*this.scale).hide();c("#smartbanner .sb-container").css("-webkit-transform","scale("+this.scale+")").css("-msie-transform","scale("+this.scale+")").css("-moz-transform","scale("+this.scale+")").css("width",c(window).width()/this.scale)}c("#smartbanner").css("position",(this.options.layer)?"absolute":"static")},listen:function(){c("#smartbanner .sb-close").on("click",c.proxy(this.close,this));c("#smartbanner .sb-button").on("click",c.proxy(this.install,this))},show:function(f){var d=c("#smartbanner");d.stop();if(this.options.layer){d.animate({top:0,display:"block"},this.options.speedIn).addClass("shown").show();c("html").animate({marginTop:this.origHtmlMargin+(this.bannerHeight*this.scale)},this.options.speedIn,"swing",f)}else{if(c.support.transition){d.animate({top:0},this.options.speedIn).addClass("shown");var e=function(){c("html").removeClass("sb-animation");if(f){f()}};c("html").addClass("sb-animation").one(c.support.transition.end,e).emulateTransitionEnd(this.options.speedIn).css("margin-top",this.origHtmlMargin+(this.bannerHeight*this.scale))}else{d.slideDown(this.options.speedIn).addClass("shown")}}},hide:function(f){var d=c("#smartbanner");d.stop();if(this.options.layer){d.animate({top:-1*this.bannerHeight*this.scale,display:"block"},this.options.speedIn).removeClass("shown");c("html").animate({marginTop:this.origHtmlMargin},this.options.speedIn,"swing",f)}else{if(c.support.transition){d.css("top",-1*this.bannerHeight*this.scale).removeClass("shown");var e=function(){c("html").removeClass("sb-animation");if(f){f()}};c("html").addClass("sb-animation").one(c.support.transition.end,e).emulateTransitionEnd(this.options.speedOut).css("margin-top",this.origHtmlMargin)}else{d.slideUp(this.options.speedOut).removeClass("shown")}}},close:function(d){d.preventDefault();this.hide();this.setCookie("sb-closed","true",this.options.daysHidden)},install:function(d){datalayer.clic={};datalayer.clic.type="cta utiliser";datalayer.clic.libelle="smart app banner";delete datalayer.clic;if(this.options.hideOnInstall){this.hide()}this.setCookie("sb-installed","true",this.options.daysReminder)},setCookie:function(d,f,e){var g=new Date();g.setDate(g.getDate()+e);f=encodeURI(f)+((e==null)?"":"; expires="+g.toUTCString());document.cookie=d+"="+f+"; path=/;"},getCookie:function(e){var f,d,h,g=document.cookie.split(";");for(f=0;f<g.length;f++){d=g[f].substr(0,g[f].indexOf("="));h=g[f].substr(g[f].indexOf("=")+1);d=d.replace(/^\s+|\s+$/g,"");if(d==e){return decodeURI(h)}}return null},switchType:function(){var d=this;this.hide(function(){d.type=d.type=="android"?"ios":"android";var e=c(d.type=="android"?'meta[name="google-play-app"]':'meta[name="apple-itunes-app"]').attr("content");d.appId=/app-id=([^\s,]+)/.exec(e)[1];c("#smartbanner").detach();d.create();d.show()})}};c.smartbanner=function(e){var g=c(window),f=g.data("smartbanner"),d=typeof e=="object"&&e;if(!f){g.data("smartbanner",(f=new a(d)))}if(typeof e=="string"){f[e]()}};c.smartbanner.defaults={title:null,author:null,price:"FREE",appStoreLanguage:"us",inAppStore:"On the App Store",inGooglePlay:"In Google Play",inAmazonAppStore:"In the Amazon Appstore",inWindowsStore:"In the Windows Store",GooglePlayParams:null,icon:null,iconGloss:null,button:"VIEW",url:null,scale:"auto",speedIn:300,speedOut:400,daysHidden:15,daysReminder:90,force:null,hideOnInstall:true,layer:false,iOSUniversalApp:true,appendToSelector:"body"};c.smartbanner.Constructor=a;function b(){var f=document.createElement("smartbanner");var e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var d in e){if(f.style[d]!==undefined){return{end:e[d]}}}return false}if(c.support.transition!==undefined){return}c.fn.emulateTransitionEnd=function(f){var e=false,d=this;c(this).one(c.support.transition.end,function(){e=true});var g=function(){if(!e){c(d).trigger(c.support.transition.end)}};setTimeout(g,f);return this};c(function(){c.support.transition=b()})}(window.jQuery);
$.smartbanner({author:"BPCE",price:"",inAppStore:"",inGooglePlay:"",inAmazonAppStore:"",inWindowsStore:"",icon:1,GooglePlayParams:null,button:"UTILISER",daysHidden:200,daysReminder:200,force:null,layer:true,iOSUniversalApp:true,speedIn:100,speedOut:100});